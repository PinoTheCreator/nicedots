#!/bin/sh

STEP=5
vol="$(pamixer --get-volume)"
STATUS=$(pamixer --get-mute)
  

block(){
  YLW="#fabd2f"
  BLC="#282828"
  WHT="#ebdbb2"
  
  FG=$WHT
  BG=$BLC
  
  case $BLOCK_BUTTON in
  	1) setsid -f st -e pulsemixer ;;
  	6) st -e "$EDITOR" "$0" ;;
  esac
  
  [[ $vol -ge 0 ]] && icon="ðŸ”ˆ"
  [[ $vol -gt 33 ]] && icon="ðŸ”‰"
  [[ $vol -gt 64 ]] && icon="ðŸ”Š" && BG=$YLW && FG=$BLC
  $STATUS && icon="ðŸ”‡"
  
  echo "^c$FG^^b$BG^ $icon$vol% ^d^"
}

upd(){
  pkill -RTMIN+13 dwmblocks
  mpv /usr/share/sounds/freedesktop/stereo/audio-volume-change.oga &
}

case $1 in
  --inc)  pamixer -i $STEP
          pamixer -u
          ;;

  --dec)  pamixer -d $STEP
          pamixer -u
          ;;
  --mute) pamixer -t;;
  *) false;;
esac

[[ $1 ]] && upd

block
